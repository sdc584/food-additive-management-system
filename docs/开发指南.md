# é£Ÿå“æ·»åŠ å‰‚ç®¡ç†ç³»ç»Ÿ - å¼€å‘æŒ‡å—

## é¡¹ç›®æ¦‚è¿°

æœ¬ç³»ç»Ÿé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼ŒåŒ…å«4ä¸ªç‹¬ç«‹é¡¹ç›®ï¼š
- **user-backend**: ç”¨æˆ·ç«¯åç«¯ (ç«¯å£8081)
- **admin-backend**: ç®¡ç†ç«¯åç«¯ (ç«¯å£8082)
- **user-frontend**: ç”¨æˆ·ç«¯å‰ç«¯ (ç«¯å£8080)
- **admin-frontend**: ç®¡ç†ç«¯å‰ç«¯ (ç«¯å£8083)

## åç«¯å¼€å‘æŒ‡å—

### 1. é¡¹ç›®ç»“æ„

```
user-backend/admin-backend/
â”œâ”€â”€ src/main/java/com/foodadditive/{user|admin}/
â”‚   â”œâ”€â”€ entity/          # å®ä½“ç±»
â”‚   â”œâ”€â”€ mapper/          # MyBatis Mapperæ¥å£
â”‚   â”œâ”€â”€ service/         # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ controller/      # æ§åˆ¶å™¨å±‚
â”‚   â”œâ”€â”€ config/          # é…ç½®ç±»
â”‚   â”œâ”€â”€ common/          # å…¬å…±ç±»(Result, Constantsç­‰)
â”‚   â”œâ”€â”€ interceptor/     # æ‹¦æˆªå™¨
â”‚   â””â”€â”€ aspect/          # åˆ‡é¢(æ—¥å¿—ç­‰)
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ mapper/          # MyBatis XMLæ–‡ä»¶
â”‚   â””â”€â”€ application.yml  # é…ç½®æ–‡ä»¶
â””â”€â”€ pom.xml
```

### 2. ä»£ç ç”Ÿæˆæ­¥éª¤

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨MyBatis Plusä»£ç ç”Ÿæˆå™¨

1. æ·»åŠ ä»£ç ç”Ÿæˆå™¨ä¾èµ–åˆ°pom.xml:
```xml
<dependency>
    <groupId>com.baomidou</groupId>
    <artifactId>mybatis-plus-generator</artifactId>
    <version>3.5.3.1</version>
</dependency>
<dependency>
    <groupId>org.freemarker</groupId>
    <artifactId>freemarker</artifactId>
    <version>2.3.32</version>
</dependency>
```

2. åˆ›å»ºä»£ç ç”Ÿæˆå™¨ç±» (è§é™„å½•A)

3. è¿è¡Œç”Ÿæˆå™¨ï¼Œè‡ªåŠ¨ç”ŸæˆEntityã€Mapperã€Serviceã€Controller

#### æ–¹å¼äºŒï¼šä½¿ç”¨IDEAæ’ä»¶

1. å®‰è£…æ’ä»¶: MyBatisX æˆ– EasyCode
2. è¿æ¥æ•°æ®åº“
3. å³é”®è¡¨å -> ç”Ÿæˆä»£ç 
4. é€‰æ‹©ç”Ÿæˆè·¯å¾„å’Œæ¨¡æ¿

### 3. éœ€è¦ç”Ÿæˆçš„å®ä½“ç±» (10ä¸ª)

| åºå· | å®ä½“ç±» | è¡¨å | è¯´æ˜ |
|------|--------|------|------|
| 1 | SysUser | sys_user | ç”¨æˆ·è¡¨ |
| 2 | AdditiveCategory | additive_category | æ·»åŠ å‰‚åˆ†ç±»è¡¨ |
| 3 | FoodAdditive | food_additive | é£Ÿå“æ·»åŠ å‰‚ä¿¡æ¯è¡¨ |
| 4 | Supplier | supplier | ä¾›åº”å•†è¡¨ |
| 5 | PurchaseRecord | purchase_record | é‡‡è´­è®°å½•è¡¨ |
| 6 | Inventory | inventory | åº“å­˜è¡¨ |
| 7 | UsageRecord | usage_record | ä½¿ç”¨è®°å½•è¡¨ |
| 8 | TestReport | test_report | æ£€æµ‹æŠ¥å‘Šè¡¨ |
| 9 | Warning | warning | é¢„è­¦è¡¨ |
| 10 | OperationLog | operation_log | æ“ä½œæ—¥å¿—è¡¨ |

### 4. å…¬å…±ç±»å¼€å‘

#### 4.1 ç»Ÿä¸€è¿”å›ç»“æœç±» (Result.java)

```java
package com.foodadditive.{user|admin}.common;

import lombok.Data;
import java.io.Serializable;

@Data
public class Result<T> implements Serializable {
    private Integer code;
    private String message;
    private T data;
    
    public static <T> Result<T> success(T data) {
        Result<T> result = new Result<>();
        result.setCode(200);
        result.setMessage("æ“ä½œæˆåŠŸ");
        result.setData(data);
        return result;
    }
    
    public static <T> Result<T> error(String message) {
        Result<T> result = new Result<>();
        result.setCode(500);
        result.setMessage(message);
        return result;
    }
}
```

#### 4.2 JWTå·¥å…·ç±» (JwtUtil.java)

ç”¨äºç”Ÿæˆå’ŒéªŒè¯JWT token

#### 4.3 å¯†ç åŠ å¯†å·¥å…·ç±» (PasswordUtil.java)

ä½¿ç”¨BCryptåŠ å¯†å¯†ç 

### 5. ç”¨æˆ·ç«¯ä¸ç®¡ç†ç«¯åŠŸèƒ½å·®å¼‚

#### ç”¨æˆ·ç«¯åç«¯ (user-backend)

**å¼€æ”¾çš„æ¥å£:**
- æŸ¥çœ‹æ·»åŠ å‰‚ä¿¡æ¯ (åªè¯»)
- æŸ¥çœ‹åº“å­˜ä¿¡æ¯ (åªè¯»)
- æäº¤ä½¿ç”¨è®°å½• (æ–°å¢)
- æŸ¥çœ‹æ£€æµ‹æŠ¥å‘Š (åªè¯»)
- æŸ¥çœ‹é¢„è­¦ä¿¡æ¯ (åªè¯»)
- ä¸ªäººä¿¡æ¯ç®¡ç†

**é™åˆ¶:**
- ä¸èƒ½å¢åˆ æ”¹æ·»åŠ å‰‚ä¿¡æ¯
- ä¸èƒ½ç®¡ç†ä¾›åº”å•†
- ä¸èƒ½ç®¡ç†é‡‡è´­
- ä¸èƒ½æŸ¥çœ‹å…¶ä»–ç”¨æˆ·ä¿¡æ¯
- ä¸èƒ½æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—

#### ç®¡ç†ç«¯åç«¯ (admin-backend)

**å®Œæ•´æƒé™:**
- æ‰€æœ‰ç”¨æˆ·ç«¯åŠŸèƒ½
- æ·»åŠ å‰‚ä¿¡æ¯ç®¡ç† (å¢åˆ æ”¹æŸ¥)
- åˆ†ç±»ç®¡ç† (å¢åˆ æ”¹æŸ¥)
- ä¾›åº”å•†ç®¡ç† (å¢åˆ æ”¹æŸ¥)
- é‡‡è´­ç®¡ç† (å¢åˆ æ”¹æŸ¥)
- åº“å­˜ç®¡ç† (å¢åˆ æ”¹æŸ¥)
- æ£€æµ‹æŠ¥å‘Šç®¡ç† (å¢åˆ æ”¹æŸ¥)
- ç”¨æˆ·ç®¡ç† (å¢åˆ æ”¹æŸ¥)
- é¢„è­¦å¤„ç†
- ç³»ç»Ÿæ—¥å¿—æŸ¥çœ‹
- æ•°æ®ç»Ÿè®¡åˆ†æ
- æ•°æ®å¯¼å‡º (Excel)

### 6. å…³é”®ä¸šåŠ¡é€»è¾‘

#### 6.1 é‡‡è´­å…¥åº“æµç¨‹
1. åˆ›å»ºé‡‡è´­è®°å½• (çŠ¶æ€: PENDING)
2. å®¡æ ¸é€šè¿‡åæ›´æ–°åº“å­˜ (çŠ¶æ€: COMPLETED)
3. æ›´æ–°åº“å­˜è¡¨çš„ current_stock
4. è®°å½•æ“ä½œæ—¥å¿—

#### 6.2 ä½¿ç”¨å‡ºåº“æµç¨‹
1. åˆ›å»ºä½¿ç”¨è®°å½•
2. æ‰£å‡åº“å­˜
3. æ£€æŸ¥åº“å­˜æ˜¯å¦ä½äºæœ€å°å€¼
4. å¦‚æœä½äºæœ€å°å€¼ï¼Œåˆ›å»ºåº“å­˜é¢„è­¦
5. è®°å½•æ“ä½œæ—¥å¿—

#### 6.3 é¢„è­¦ç”Ÿæˆé€»è¾‘
- åº“å­˜é¢„è­¦: å½“ current_stock < min_stock æ—¶è§¦å‘
- è¿‡æœŸé¢„è­¦: å½“ expiry_date - å½“å‰æ—¥æœŸ < 30å¤© æ—¶è§¦å‘

### 7. æ¥å£è®¾è®¡è§„èŒƒ

#### RESTful APIè§„èŒƒ

```
GET    /api/{user|admin}/additives          # æŸ¥è¯¢åˆ—è¡¨
GET    /api/{user|admin}/additives/{id}     # æŸ¥è¯¢è¯¦æƒ…
POST   /api/{user|admin}/additives          # æ–°å¢
PUT    /api/{user|admin}/additives/{id}     # æ›´æ–°
DELETE /api/{user|admin}/additives/{id}     # åˆ é™¤
```

#### ç»Ÿä¸€è¿”å›æ ¼å¼

```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {}
}
```

### 8. æ•°æ®åº“è¿æ¥é…ç½®

ä¿®æ”¹ `application.yml` ä¸­çš„æ•°æ®åº“é…ç½®:

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/food_additive_system
    username: root
    password: your_password
```

## å‰ç«¯å¼€å‘æŒ‡å—

### 1. åˆå§‹åŒ–Vueé¡¹ç›®

#### ç”¨æˆ·ç«¯å‰ç«¯

```bash
cd user-frontend
vue create .
# é€‰æ‹©: Vue 2.x, Router, Vuex
npm install element-ui axios --save
```

#### ç®¡ç†ç«¯å‰ç«¯

```bash
cd admin-frontend
vue create .
# é€‰æ‹©: Vue 2.x, Router, Vuex
npm install element-ui axios --save
```

### 2. é¡¹ç›®ç»“æ„

```
user-frontend/admin-frontend/
â”œâ”€â”€ public/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/             # APIæ¥å£
â”‚   â”œâ”€â”€ assets/          # é™æ€èµ„æº
â”‚   â”œâ”€â”€ components/      # ç»„ä»¶
â”‚   â”œâ”€â”€ router/          # è·¯ç”±
â”‚   â”œâ”€â”€ store/           # VuexçŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ utils/           # å·¥å…·ç±»
â”‚   â”œâ”€â”€ views/           # é¡µé¢
â”‚   â”œâ”€â”€ App.vue
â”‚   â””â”€â”€ main.js
â”œâ”€â”€ package.json
â””â”€â”€ vue.config.js
```

### 3. éœ€è¦å¼€å‘çš„é¡µé¢

#### ç”¨æˆ·ç«¯é¡µé¢
1. ç™»å½•é¡µé¢
2. é¦–é¡µ/ä»ªè¡¨ç›˜
3. æ·»åŠ å‰‚ä¿¡æ¯æŸ¥è¯¢
4. åº“å­˜æŸ¥è¯¢
5. ä½¿ç”¨è®°å½•æäº¤
6. æ£€æµ‹æŠ¥å‘ŠæŸ¥çœ‹
7. é¢„è­¦ä¿¡æ¯æŸ¥çœ‹
8. ä¸ªäººä¸­å¿ƒ

#### ç®¡ç†ç«¯é¡µé¢
1. ç™»å½•é¡µé¢
2. é¦–é¡µ/æ•°æ®ç»Ÿè®¡
3. æ·»åŠ å‰‚ç®¡ç†
4. åˆ†ç±»ç®¡ç†
5. ä¾›åº”å•†ç®¡ç†
6. é‡‡è´­ç®¡ç†
7. åº“å­˜ç®¡ç†
8. ä½¿ç”¨è®°å½•ç®¡ç†
9. æ£€æµ‹æŠ¥å‘Šç®¡ç†
10. é¢„è­¦ç®¡ç†
11. ç”¨æˆ·ç®¡ç†
12. æ“ä½œæ—¥å¿—

### 4. Axiosé…ç½®

åˆ›å»º `src/utils/request.js`:

```javascript
import axios from 'axios'

const service = axios.create({
  baseURL: process.env.VUE_APP_BASE_API, // ç”¨æˆ·ç«¯: http://localhost:8081/api/user
  timeout: 5000
})

// è¯·æ±‚æ‹¦æˆªå™¨
service.interceptors.request.use(
  config => {
    const token = localStorage.getItem('token')
    if (token) {
      config.headers['Authorization'] = 'Bearer ' + token
    }
    return config
  },
  error => {
    return Promise.reject(error)
  }
)

// å“åº”æ‹¦æˆªå™¨
service.interceptors.response.use(
  response => {
    const res = response.data
    if (res.code !== 200) {
      return Promise.reject(new Error(res.message || 'Error'))
    }
    return res
  },
  error => {
    return Promise.reject(error)
  }
)

export default service
```

## é™„å½•

### é™„å½•A: MyBatis Plusä»£ç ç”Ÿæˆå™¨ç¤ºä¾‹

è§ `docs/CodeGenerator.java`

### é™„å½•B: å®Œæ•´çš„Entityç¤ºä¾‹

è§ `docs/EntityExample.java`

### é™„å½•C: å®Œæ•´çš„Controllerç¤ºä¾‹

è§ `docs/ControllerExample.java`

## å¼€å‘é¡ºåºå»ºè®®

1. âœ… æ•°æ®åº“è®¾è®¡å’Œåˆ›å»º
2. âœ… åç«¯é¡¹ç›®åˆå§‹åŒ–
3. ğŸ”„ åç«¯ä»£ç ç”Ÿæˆ (Entity, Mapper, Service, Controller)
4. ğŸ”„ åç«¯å…¬å…±ç±»å¼€å‘ (Result, JWT, æ‹¦æˆªå™¨ç­‰)
5. ğŸ”„ åç«¯ä¸šåŠ¡é€»è¾‘å¼€å‘
6. ğŸ”„ åç«¯æ¥å£æµ‹è¯•
7. ğŸ”„ å‰ç«¯é¡¹ç›®åˆå§‹åŒ–
8. ğŸ”„ å‰ç«¯é¡µé¢å¼€å‘
9. ğŸ”„ å‰åç«¯è”è°ƒ
10. ğŸ”„ ç³»ç»Ÿæµ‹è¯•
11. ğŸ”„ éƒ¨ç½²
12. ğŸ”„ ç¼–å†™æŠ¥å‘Š

## æ³¨æ„äº‹é¡¹

1. ç”¨æˆ·ç«¯å’Œç®¡ç†ç«¯ä½¿ç”¨ç›¸åŒçš„æ•°æ®åº“
2. ç”¨æˆ·ç«¯åªèƒ½æŸ¥è¯¢å’Œæäº¤ä½¿ç”¨è®°å½•ï¼Œä¸èƒ½ç®¡ç†æ•°æ®
3. ç®¡ç†ç«¯æ‹¥æœ‰å®Œæ•´çš„ç®¡ç†æƒé™
4. æ‰€æœ‰æ“ä½œéƒ½è¦è®°å½•åˆ°æ“ä½œæ—¥å¿—è¡¨
5. å¯†ç å¿…é¡»åŠ å¯†å­˜å‚¨
6. ä½¿ç”¨JWTè¿›è¡Œèº«ä»½è®¤è¯
7. å‰ç«¯éœ€è¦åšæƒé™æ§åˆ¶ï¼Œé˜²æ­¢è¶Šæƒè®¿é—®

